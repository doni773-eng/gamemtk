<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Math Maze</title>

<style>
body{
    margin:0;
    font-family:Arial;
    text-align:center;
    background:#f4f6f8;
}

h2{margin:10px;}

canvas{
    background:white;
    border:4px solid #333;
}

#score{
    margin-bottom:10px;
    font-size:18px;
}

.controls button{
    font-size:18px;
    margin:5px;
    padding:8px 12px;
}
</style>
</head>

<body>

<h2 id="question">Memuat soal...</h2>
<div id="score">Skor: 0</div>

<canvas id="game" width="400" height="400"></canvas>
  
  <div id="confirmBox" style="display:none; margin-top:10px;">
  <p id="confirmText"></p>
  <button onclick="confirmYes()">YA</button>
  <button onclick="confirmNo()">TIDAK</button>
</div>


<div class="controls">
<button onclick="move(0,-1)">⬆️</button><br>
<button onclick="move(-1,0)">⬅️</button>
<button onclick="move(1,0)">➡️</button><br>
<button onclick="move(0,1)">⬇️</button>
</div>

<script>
  let selectedAnswer = null;
let waitingConfirm = false;

const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const tile = 40;

// 1 = tembok, 0 = jalan
const maze = [
[1,1,1,1,1,1,1,1,1,1],
[1,0,0,0,1,0,0,0,0,1],
[1,0,1,0,1,0,1,1,0,1],
[1,0,1,0,0,0,0,1,0,1],
[1,0,1,1,1,1,0,1,0,1],
[1,0,0,0,0,1,0,1,0,1],
[1,1,1,1,0,1,0,1,0,1],
[1,0,0,1,0,0,0,1,0,1],
[1,0,0,0,0,1,0,0,0,1],
[1,1,1,1,1,1,1,1,1,1]
];

let player = {x:1,y:1};
let score = 0;

const questions = [
{q:"1/2 + 1/4 =", a:"3/4", opt:["1/4","3/4","2/4","1"]},
{q:"0.5 + 0.25 =", a:"0.75", opt:["0.5","0.75","1","0.25"]},
{q:"25% + 25% =", a:"50%", opt:["25%","50%","75%","100%"]},
{q:"3 + 7 =", a:"10", opt:["9","10","11","8"]},
{q:"1/3 + 1/3 =", a:"2/3", opt:["1/3","2/3","3/3","1/6"]}
];

let current;
let answers=[];

function newQuestion(){
current = questions[Math.floor(Math.random()*questions.length)];
document.getElementById("question").innerText = current.q;

answers = [
{x:8,y:1,val:current.opt[0]},
{x:8,y:3,val:current.opt[1]},
{x:8,y:5,val:current.opt[2]},
{x:8,y:7,val:current.opt[3]}
];

player={x:1,y:1};
draw();
}

function draw(){
ctx.clearRect(0,0,400,400);

// maze
for(let y=0;y<10;y++){
for(let x=0;x<10;x++){
if(maze[y][x]===1){
ctx.fillStyle="#333";
ctx.fillRect(x*tile,y*tile,tile,tile);
}else{
ctx.strokeRect(x*tile,y*tile,tile,tile);
}
}
}

// answers
answers.forEach(a=>{
ctx.fillStyle="green";
ctx.fillRect(a.x*tile,a.y*tile,tile,tile);
ctx.fillStyle="white";
ctx.fillText(a.val,a.x*tile+5,a.y*tile+25);
});

// player
ctx.fillStyle="blue";
ctx.fillRect(player.x*tile+5,player.y*tile+5,tile-10,tile-10);
}

function move(dx,dy){
let nx = player.x + dx;
let ny = player.y + dy;

if(maze[ny][nx]===1) return;

player.x=nx;
player.y=ny;

answers.forEach(a=>{
if(player.x===a.x && player.y===a.y && !waitingConfirm){

waitingConfirm = true;
selectedAnswer = a;

document.getElementById("confirmText").innerText =
"Pilih jawaban ini: " + a.val + " ?";

document.getElementById("confirmBox").style.display = "block";
}
});



draw();
}

// keyboard control
document.addEventListener("keydown",e=>{
if(e.key==="ArrowUp") move(0,-1);
if(e.key==="ArrowDown") move(0,1);
if(e.key==="ArrowLeft") move(-1,0);
if(e.key==="ArrowRight") move(1,0);
});
  function confirmYes(){

document.getElementById("confirmBox").style.display = "none";
waitingConfirm = false;

if(selectedAnswer.val === current.a){
score++;
document.getElementById("score").innerText="Skor: "+score;
alert("✅ Jawaban Benar!");
newQuestion();
}else{
alert("❌ Jawaban Salah! Kembali ke awal.");
player={x:1,y:1};
draw();
}

selectedAnswer = null;
}

function confirmNo(){
document.getElementById("confirmBox").style.display = "none";
waitingConfirm = false;
selectedAnswer = null;
}


newQuestion();
</script>
  

</body>
</html>
